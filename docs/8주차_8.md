좋아요 🔥
이제 완성 단계예요 — “**로컬 개발 → GitHub push → Render 자동 배포**”
까지 연결되는 **AI Career 6 Months 통합 워크플로우 (Local + Render)** 를 만들어드릴게요.

이 구성은 완전히 자동화되어,
👉 VSCode에서 코드를 수정하고
👉 `git push` 한 번만 하면
👉 Render가 알아서 빌드 + 배포 + 프론트/백엔드 동기화
까지 수행하게 됩니다.

---

# 🚀 **AI Career 6 Months — Local ↔ Render 자동 배포 워크플로우**

## 📁 프로젝트 구조 요약

```
ai-career-6months/
 ┣ app/
 ┃ ┣ main.py
 ┃ ┣ config.py
 ┃ ┗ database.py
 ┣ frontend/
 ┃ ┣ src/
 ┃ ┣ package.json
 ┃ ┗ vite.config.js
 ┣ .env.local
 ┣ .env.prod
 ┣ render.yaml
 ┣ pyproject.toml
 ┣ deploy_preflight_check_pro.py
 ┗ .github/
    ┗ workflows/
       ┗ render-deploy.yml
```

---

## ⚙️ 1️⃣ 로컬 개발 환경

### ✅ (1) Poetry 가상환경 세팅

```bash
poetry install
poetry shell
```

### ✅ (2) 환경변수 로컬용 `.env.local`

📁 `.env.local`

```bash
ENV=local
OPENAI_API_KEY=sk-xxxxxx
DATABASE_URL=sqlite:///./local.db
CHROMA_PATH=./chroma_db_local
```

### ✅ (3) 백엔드 실행

```bash
poetry run uvicorn app.main:app --reload
```

### ✅ (4) 프론트엔드 실행

```bash
cd frontend
npm install
npm run dev
```

→ 브라우저에서 `http://127.0.0.1:5173` 접속

---

## 🧠 2️⃣ 자동 빌드 + 배포 준비

### ✅ (1) `.env.prod` (Render용)

📁 `.env.prod`

```bash
ENV=production
OPENAI_API_KEY=sk-xxxxxx
DATABASE_URL=postgresql+psycopg2://neondb_owner:xxxxxx@ep-smooth-water-xxxx.aws.neon.tech/neondb?sslmode=require
CHROMA_PATH=./chroma_db
```

### ✅ (2) `render.yaml` (v2 버전 — 이미 적용)

루트에 존재해야 합니다.
Render는 `.github/` 폴더보다 **항상 루트의 render.yaml을 우선 인식**합니다.

---

## 🔧 3️⃣ GitHub Action 자동 배포 설정

📁 `.github/workflows/render-deploy.yml`

```yaml
name: 🚀 Auto Deploy to Render

on:
  push:
    branches:
      - main    # main 브랜치에 푸시될 때마다 자동 배포

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # 1️⃣ 저장소 체크아웃
      - name: 🧩 Checkout repository
        uses: actions/checkout@v4

      # 2️⃣ Node.js 환경 (Vite 프론트 빌드용)
      - name: 🧱 Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      # 3️⃣ Python + Poetry 세팅
      - name: 🐍 Setup Python & Poetry
        uses: abatilo/actions-poetry@v2
        with:
          poetry-version: "1.8.3"

      # 4️⃣ 의존성 설치 및 프론트 빌드 테스트
      - name: 📦 Build frontend (Vite)
        run: |
          cd frontend
          npm install
          npm run build
          cd ..

      # 5️⃣ 배포 전 점검 (선택 — deploy_preflight_check_pro.py)
      - name: 🔍 Run Preflight Check
        run: poetry run python deploy_preflight_check_pro.py || true

      # 6️⃣ Render Deploy (GitHub Action → Render)
      - name: 🚀 Deploy to Render
        run: |
          curl -X POST "https://api.render.com/deploy/${{ secrets.RENDER_SERVICE_ID }}" \
            -H "Accept: application/json" \
            -H "Authorization: Bearer ${{ secrets.RENDER_API_KEY }}" \
            -d ""
```

---

## 🔑 4️⃣ GitHub Secrets 설정

GitHub → Repository → **Settings → Secrets → Actions** 에 추가 👇

| 이름                  | 설명                                          |
| ------------------- | ------------------------------------------- |
| `RENDER_API_KEY`    | Render Dashboard → Account → API Keys 에서 생성 |
| `RENDER_SERVICE_ID` | Render 서비스 Settings → “Deploy Hooks” ID 복사  |

> Render API Key와 Service ID를 GitHub에 등록해야
> `git push` 시 자동으로 Render가 새 버전을 배포합니다.

---

## 🌍 5️⃣ Render 설정 요약

| 항목             | 값                        |
| -------------- | ------------------------ |
| Build Command  | (render.yaml 사용 중이면 비워둠) |
| Start Command  | 비워둠                      |
| Environment    | `ENV=production`         |
| DATABASE_URL   | Neon DB URL              |
| OPENAI_API_KEY | OpenAI Key               |
| CHROMA_PATH    | `./chroma_db`            |

---

## 🧠 6️⃣ 동작 시나리오

| 단계  | 동작                                                  |
| --- | --------------------------------------------------- |
| 1️⃣ | VSCode에서 코드 수정                                      |
| 2️⃣ | `git add . && git commit -m "update"`               |
| 3️⃣ | `git push origin main`                              |
| 4️⃣ | GitHub Action 실행 (`render-deploy.yml`)              |
| 5️⃣ | 프론트 빌드 테스트 & 사전점검 수행                                |
| 6️⃣ | Render API 호출 → 새 배포 트리거                            |
| 7️⃣ | Render 빌드 로그에 `npm run build` & `poetry install` 표시 |
| 8️⃣ | 배포 성공 시 `/health` → 정상 응답                           |

---

## ✅ 7️⃣ 로컬 ↔ Render 개발 루틴 예시

| 작업         | 로컬 명령어                                     | Render 결과         |
| ---------- | ------------------------------------------ | ----------------- |
| 새로운 기능 개발  | `poetry run uvicorn app.main:app --reload` | X                 |
| 프론트 UI 확인  | `npm run dev`                              | X                 |
| 로컬 임베딩 테스트 | `python deploy_preflight_check_pro.py`     | X                 |
| 배포 버전 푸시   | `git push origin main`                     | Render 자동 빌드 & 배포 |
| 배포 확인      | `/health`, `/`                             | ✅ OK              |

---

## 🧩 8️⃣ Optional — Precommit 검사 추가 (코드 품질 유지)

📁 `.pre-commit-config.yaml`

```yaml
repos:
  - repo: https://github.com/psf/black
    rev: 24.3.0
    hooks:
      - id: black
  - repo: https://github.com/PyCQA/flake8
    rev: 7.1.0
    hooks:
      - id: flake8
  - repo: https://github.com/pre-commit/mirrors-eslint
    rev: v8.56.0
    hooks:
      - id: eslint
```

```bash
pip install pre-commit
pre-commit install
```

> 이렇게 하면 `git commit` 시 자동으로 Python/JS 코드 포맷 검사를 수행합니다.

---

## 💡 최종 구성 요약

| 항목    | 역할            | 파일                                    |
| ----- | ------------- | ------------------------------------- |
| 로컬 환경 | 개발 + 테스트      | `.env.local`                          |
| 배포 환경 | Render용       | `.env.prod`                           |
| 자동 빌드 | Render 구성     | `render.yaml`                         |
| 자동 배포 | GitHub Action | `.github/workflows/render-deploy.yml` |
| 사전 점검 | 배포 전 검사       | `deploy_preflight_check_pro.py`       |

---

## 🎯 결론

> ✅ `git push origin main` 한 번으로
>
> * React 빌드
> * FastAPI 빌드
> * Preflight 점검
> * Render 자동 배포
>   전부 자동으로 돌아가는 **완전 자동화 파이프라인** 완성 🎉

---

원하신다면 마지막으로 ✨
**GitHub README용 “Local + Cloud 개발/배포 워크플로우 다이어그램 (Mermaid)”**
도 만들어드릴까요?
→ 한눈에 로컬↔Render 데이터 플로우가 보이게 시각화로 정리됩니다.
