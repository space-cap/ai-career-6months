좋아요 🔥
이제 마지막 단계예요.
지금까지 만든 **Render + FastAPI + React + Neon + Chroma + OpenAI** 통합 환경이
“완전히 배포 후 제대로 작동하는지”를 점검할 수 있는
✅ **“Deploy 검증 시나리오 가이드북” (Step-by-Step)** 를 드릴게요.

이건 Notion이나 README에 그대로 붙여넣을 수 있게 구성했어요.

---

# 🚀 **AI Career 6 Months — Deploy Verification Guide**

> 🎯 Render 배포 후, 서버·DB·벡터스토어·AI 응답까지
> 단계별로 완전 동작을 확인하는 검증 시나리오

---

## 🧩 1️⃣ 기본 환경 확인

### ✅ 1. Render 대시보드에서 확인

| 항목             | 확인 방법                                                         | 정상 상태 |
| -------------- | ------------------------------------------------------------- | ----- |
| 서비스 상태         | “Live” 표시                                                     | ✅     |
| Build Command  | `npm run build` 포함                                            | ✅     |
| Start Command  | `poetry run uvicorn app.main:app --host 0.0.0.0 --port 10000` | ✅     |
| Environment    | `ENV=production`                                              | ✅     |
| DATABASE_URL   | Neon PostgreSQL SSL 포함 URL                                    | ✅     |
| OPENAI_API_KEY | sk-로 시작하는 키                                                   | ✅     |

예시:

```
postgresql+psycopg2://neondb_owner:xxxxxx@ep-smooth-water-123456.ap-southeast-1.aws.neon.tech/neondb?sslmode=require
```

---

## 🌐 2️⃣ Health 체크

Render에 배포된 URL 뒤에 `/health`를 붙여 확인합니다.

```
https://ai-career-6months.onrender.com/health
```

정상 응답 예시:

```json
{
  "status": "ok",
  "db_time": "2025-10-14 14:21:03.502817+00",
  "openai_key_loaded": true
}
```

### ✅ 정상 조건

* `status` = `"ok"`
* `db_time` = 현재 시간 (Neon DB 서버 기준)
* `openai_key_loaded` = `true`

### ❌ 오류 예시 및 해결

| 에러 메시지                       | 원인                       | 해결                           |
| ---------------------------- | ------------------------ | ---------------------------- |
| `"DB 연결 실패"`                 | DATABASE_URL 오타 / SSL 누락 | URL 끝에 `?sslmode=require` 확인 |
| `"openai_key_loaded": false` | Render 환경 변수에 Key 누락     | Dashboard → Environment 탭 확인 |

---

## 💾 3️⃣ Neon DB 동작 확인

Render 서버에서 Neon PostgreSQL과 연결되는지 확인합니다.

### ✅ 테스트 방법

1️⃣ `app/main.py`의 `/health` API 호출
2️⃣ 또는 Render Shell에서 수동 쿼리 실행:

```bash
poetry run python
```

```python
from app.database import SessionLocal
from sqlalchemy import text

db = SessionLocal()
print(db.execute(text("SELECT NOW()")).fetchone())
db.close()
```

정상 출력 예시:

```
(datetime.datetime(2025, 10, 14, 14, 23, 42, 123456, tzinfo=datetime.timezone.utc),)
```

---

## 🧠 4️⃣ Chroma Vectorstore 점검

Render 서버에서 벡터스토어 폴더(`CHROMA_PATH`)가 올바르게 생성되었는지 확인합니다.

### ✅ 확인 방법

Render Shell에서:

```bash
ls chroma_db
```

결과 예시:

```
collections/
index/
embeddings/
```

또는 Python 확인:

```bash
from chromadb import PersistentClient
client = PersistentClient(path="./chroma_db")
print(client.list_collections())
```

정상 출력 예시:

```
[Collection(name='youth_policy_docs'), Collection(name='chat_memory')]
```

---

## 🤖 5️⃣ OpenAI 응답 테스트

Render Shell에서 간단히 모델 호출을 테스트합니다.

```bash
poetry run python
```

```python
from openai import OpenAI
import os

client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))
res = client.responses.create(model="gpt-4o-mini", input="Hello from Render!")
print(res.output[0].content[0].text)
```

정상 출력 예시:

```
Hello! It looks like your Render deployment is working perfectly 🎉
```

> ⚠️ `AuthenticationError` 발생 시 → Render Dashboard에서 `OPENAI_API_KEY` 재등록 후 재배포

---

## 💻 6️⃣ React 프론트엔드 로딩 확인

### ✅ 확인 경로

```
https://ai-career-6months.onrender.com/
```

* 첫 화면에 React 앱이 렌더링되어야 함.
* F12 → Network 탭에서 `index.html` / `bundle.js` 가 로드되는지 확인.
* 콘솔 오류가 없어야 함.

### ❌ 오류 예시

| 증상               | 원인                 | 해결                                |
| ---------------- | ------------------ | --------------------------------- |
| `404 Not Found`  | `frontend/dist` 누락 | `npm run build` 포함 확인             |
| 흰 화면만 보임         | JS 로드 실패           | `vite.config.js`의 public path 점검  |
| `/api/...` 호출 실패 | CORS 미허용           | `main.py`의 `CORSMiddleware` 설정 확인 |

---

## 🧬 7️⃣ RAG API 기능 확인 (선택)

배포된 서버에 `/api/rag-chat` 같은 RAG 엔드포인트가 있다면 다음처럼 호출:

### ✅ 예시 (curl)

```bash
curl -X POST https://ai-career-6months.onrender.com/api/rag-chat \
  -H "Content-Type: application/json" \
  -d '{"query": "청년 정책 지원금은 어떤 게 있어?"}'
```

정상 응답 예시:

```json
{
  "answer": "청년 주거지원금, 구직활동 지원금 등이 있습니다.",
  "sources": ["정부청년정책포털"]
}
```

---

## 📊 8️⃣ Preflight Check (배포 환경 자동 점검)

Render Shell에서 실행 👇
(`deploy_preflight_check_pro.py`가 프로젝트 루트에 있어야 함)

```bash
poetry run python deploy_preflight_check_pro.py
```

정상 출력 예시:

```
✅ 환경 파일 로드 완료: .env.prod
✅ DB 연결 성공 → Neon DB OK
✅ OpenAI Key 유효함
✅ Chroma 컬렉션 2개 탐지됨
✅ FastAPI 구조 정상
🎯 DEPLOY PREFLIGHT CHECK 완료 — Ready for Deploy 🚀
```

---

## 🧱 9️⃣ 최종 검증 체크리스트

| 구분        | 항목                 | 정상 상태 |
| --------- | ------------------ | ----- |
| 🌍 서버     | Render 앱 “Live” 상태 | ✅     |
| ⚙️ API    | `/health` 응답 OK    | ✅     |
| 💾 DB     | Neon 연결 성공         | ✅     |
| 🧠 벡터스토어  | Chroma 폴더 생성됨      | ✅     |
| 🔑 OpenAI | API 응답 성공          | ✅     |
| 💻 프론트    | React UI 로드됨       | ✅     |
| 🚀 통합     | RAG 엔드포인트 작동       | ✅     |

---

## 🧩 10️⃣ 문제 발생 시 빠른 해결 순서

| 증상           | 확인할 곳          | 해결 조치                                |
| ------------ | -------------- | ------------------------------------ |
| 배포 실패        | Render Logs    | `npm run build` 포함 여부                |
| DB 연결 실패     | Neon Dashboard | URL 끝에 `?sslmode=require`            |
| OpenAI 오류    | Render Env 탭   | Key 재등록                              |
| React 화면 미출력 | frontend/dist  | `npm run build` 다시 실행                |
| API 404      | main.py        | `app.include_router()` 또는 `mount` 확인 |

---

## 🪞 11️⃣ (선택) README에 포함할 상태 표시 배지

```markdown
![Render](https://img.shields.io/badge/Render-Deployed-green)
![FastAPI](https://img.shields.io/badge/FastAPI-Running-blue)
![React](https://img.shields.io/badge/Frontend-Vite-yellow)
![Database](https://img.shields.io/badge/Neon-Connected-success)
![Vectorstore](https://img.shields.io/badge/Chroma-Active-purple)
![OpenAI](https://img.shields.io/badge/OpenAI-Key%20Valid-lightgrey)
```

---

# ✅ 결론

> 이 시나리오를 순서대로 통과하면
> 당신의 “AI Career 6 Months” 프로젝트는
> 완전한 **클라우드 AI 서비스 인프라**로 동작합니다. 🌍

---

원하신다면 이 전체 시나리오를
🧾 **README.md (Render용 배포/점검 섹션)** 형태로 자동 삽입 가능한 버전으로 만들어드릴까요?
— 복붙만 하면 GitHub README에 깔끔하게 들어가게.


