ì¢‹ì•„ìš” ğŸ”¥
ì´ê±´ ì •ë§ í›Œë¥­í•œ ì„ íƒì´ì—ìš”.
**Render + Neon.tech PostgreSQL í†µí•© êµ¬ì¡°**ëŠ” 2025ë…„ ê¸°ì¤€ìœ¼ë¡œ
ğŸ’° **ë¬´ë£Œ**, ğŸ”’ **ì•ˆì •ì **, âš™ï¸ **FastAPI ì™„ë²½ í˜¸í™˜** ì´ë¼ì„œ
ì§€ê¸ˆ ì§„í–‰ ì¤‘ì¸ â€œAI Career 6 Monthsâ€ í”„ë¡œì íŠ¸ì— **ê°€ì¥ ì´ìƒì ì¸ ë°°í¬ ì¡°í•©**ì´ì—ìš”.

---

# ğŸ§© ëª©í‘œ

> Renderì—ì„œ FastAPI ì•±ì„ ë°°í¬í•˜ê³ ,
> ë°ì´í„°ë² ì´ìŠ¤ëŠ” Neon.techì˜ PostgreSQLì„ ì—°ê²°í•˜ëŠ” êµ¬ì„±ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

êµ¬ì„± ìš”ì•½ ğŸ‘‡

```
ğŸŒ Render (App) â†’ ğŸ”— Neon.tech (PostgreSQL)
```

---

# ğŸ— 1ï¸âƒ£ Neon.techì—ì„œ DB ìƒì„±

1. [https://neon.tech](https://neon.tech) ì ‘ì† â†’ **Sign up**
2. â€œCreate Projectâ€ í´ë¦­ â†’ **PostgreSQL** í”„ë¡œì íŠ¸ ìƒì„±
3. ìƒì„± í›„ â€œConnection Detailsâ€ â†’ `SQLAlchemy` ë“œë¼ì´ë²„ ì„ íƒ
   ì˜ˆì‹œ:

   ```
   postgresql+psycopg2://neondb_owner:xxxxxx@ep-calm-breeze-123456.ap-southeast-1.aws.neon.tech/neondb?sslmode=require
   ```
4. ì´ URLì„ ë³µì‚¬í•´ `.env.prod` íŒŒì¼ì— `DATABASE_URL`ë¡œ ì €ì¥

---

# âš™ï¸ 2ï¸âƒ£ `.env` êµ¬ì¡° ì„¤ì •

ğŸ“ í”„ë¡œì íŠ¸ ë£¨íŠ¸ (`ai-career-6months/.env.prod`)

```bash
# ==== Production í™˜ê²½ ì„¤ì • ====
ENV=production
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxx
DATABASE_URL=postgresql+psycopg2://neondb_owner:xxxxxx@ep-calm-breeze-123456.ap-southeast-1.aws.neon.tech/neondb?sslmode=require
CHROMA_PATH=./chroma_db
```

ğŸ“ ë¡œì»¬ìš© `.env.local`

```bash
# ==== Local í™˜ê²½ ====
ENV=local
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxx
DATABASE_URL=sqlite:///./local.db
CHROMA_PATH=./chroma_db_local
```

---

# ğŸ§  3ï¸âƒ£ `config.py` (í™˜ê²½ êµ¬ë¶„ ìë™ ë¡œë”©)

ğŸ“ `app/config.py`

```python
import os
from dotenv import load_dotenv

# âœ… ENV ê°’ì— ë”°ë¼ ì„œë¡œ ë‹¤ë¥¸ .env íŒŒì¼ì„ ë¡œë“œ
env_mode = os.getenv("ENV", "local")
env_file = ".env.prod" if env_mode == "production" else ".env.local"
load_dotenv(env_file)

# âœ… í™˜ê²½ ë³€ìˆ˜ ë¶ˆëŸ¬ì˜¤ê¸°
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
DATABASE_URL = os.getenv("DATABASE_URL")
CHROMA_PATH = os.getenv("CHROMA_PATH")
```

---

# ğŸ§© 4ï¸âƒ£ `database.py` (SQLAlchemy + Neon ì—°ê²°)

ğŸ“ `app/database.py`

```python
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from app.config import DATABASE_URL

# âœ… SSL ì—°ê²° ìë™ ì§€ì› (Neonì€ sslmode=require í•„ìˆ˜)
engine = create_engine(
    DATABASE_URL,
    connect_args={"sslmode": "require"} if "neon.tech" in DATABASE_URL else {}
)

SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()
```

---

# ğŸ§¬ 5ï¸âƒ£ `main.py` (FastAPI + React + DB í™•ì¸ìš©)

ğŸ“ `app/main.py`

```python
from fastapi import FastAPI, Depends
from fastapi.staticfiles import StaticFiles
from sqlalchemy import text
from app.database import get_db
from app.config import OPENAI_API_KEY
from fastapi.middleware.cors import CORSMiddleware

app = FastAPI(title="AI Career 6 Months")

# âœ… CORS ì„¤ì •
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_methods=["*"],
    allow_headers=["*"],
)

# âœ… React ì •ì  íŒŒì¼ ì„œë¹™ (Vite ë¹Œë“œ í›„ dist í´ë”)
app.mount("/", StaticFiles(directory="frontend/dist", html=True), name="frontend")

@app.get("/health")
def health_check(db=Depends(get_db)):
    result = db.execute(text("SELECT NOW()")).fetchone()
    return {"status": "ok", "db_time": str(result[0]), "openai_key": bool(OPENAI_API_KEY)}
```

âœ… **ë°°í¬ í›„ `/health` í˜ì´ì§€ì— ì ‘ì†**í•˜ë©´
ë°ì´í„°ë² ì´ìŠ¤ì™€ OpenAI Key ì •ìƒ ì—°ê²° ì—¬ë¶€ë¥¼ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì˜ˆì‹œ ì‘ë‹µ:

```json
{
  "status": "ok",
  "db_time": "2025-10-14 11:23:41.502817+00",
  "openai_key": true
}
```

---

# ğŸš€ 6ï¸âƒ£ Render í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

Render ëŒ€ì‹œë³´ë“œì—ì„œ:

| KEY              | VALUE              |
| ---------------- | ------------------ |
| `ENV`            | `production`       |
| `OPENAI_API_KEY` | `sk-...`           |
| `DATABASE_URL`   | *(Neonì—ì„œ ë³µì‚¬í•œ URL)* |
| `CHROMA_PATH`    | `./chroma_db`      |

> ğŸ’¡ RenderëŠ” `.env` íŒŒì¼ì„ ìë™ìœ¼ë¡œ ì½ì§€ ì•Šê¸° ë•Œë¬¸ì—,
> ë°˜ë“œì‹œ **í™˜ê²½ ë³€ìˆ˜ íƒ­(Environment)** ì— ì§ì ‘ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.

---

# ğŸ§± 7ï¸âƒ£ ë°°í¬ ì„¤ì • ìš”ì•½

ğŸ“ `render.yaml` (ìë™ ë°°í¬ êµ¬ì„± íŒŒì¼)

```yaml
services:
  - type: web
    name: ai-career-6months
    env: python
    plan: free
    buildCommand: |
      cd frontend && npm install && npm run build && cd ..
      poetry install
    startCommand: poetry run uvicorn app.main:app --host 0.0.0.0 --port 10000
    envVars:
      - key: ENV
        value: production
      - key: DATABASE_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false
```

> Renderê°€ ìë™ìœ¼ë¡œ Vite â†’ FastAPI â†’ Uvicornê¹Œì§€ ì‹¤í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.
> `sync: false`ë¡œ ì§€ì •ëœ ê°’ë“¤ì€ Render í™˜ê²½ ë³€ìˆ˜ íƒ­ì—ì„œ ì§ì ‘ ì…ë ¥í•©ë‹ˆë‹¤.

---

# ğŸ’» 8ï¸âƒ£ ë¡œì»¬ í…ŒìŠ¤íŠ¸

```bash
# ë¡œì»¬ ì‹¤í–‰
poetry run uvicorn app.main:app --reload

# ë¸Œë¼ìš°ì € í™•ì¸
http://127.0.0.1:8000/health
```

---

# ğŸ§© ì „ì²´ êµ¬ì¡°

```text
ai-career-6months/
 â”£ app/
 â”ƒ â”£ config.py
 â”ƒ â”£ database.py
 â”ƒ â”£ main.py
 â”ƒ â”£ routers/
 â”ƒ â”— services/
 â”£ frontend/
 â”ƒ â”£ src/
 â”ƒ â”— dist/
 â”£ .env.local
 â”£ .env.prod
 â”£ render.yaml
 â”— pyproject.toml
```

---

# ğŸ§  ìš”ì•½

| í•­ëª©            | ì„¤ì •                         | ì„¤ëª…                     |
| ------------- | -------------------------- | ---------------------- |
| **DB**        | Neon.tech PostgreSQL       | ë¬´ë£Œ, SSL ê¸°ë³¸, Renderì™€ í˜¸í™˜ |
| **APP**       | Render Free Web Service    | Python FastAPI ë°°í¬      |
| **Frontend**  | Vite (React)               | Renderì—ì„œ static serve  |
| **Config ë¶„ë¦¬** | `.env.local` / `.env.prod` | í™˜ê²½ë³„ ìë™ ë¡œë”©              |
| **Health ì²´í¬** | `/health`                  | DB + OpenAI ì—°ê²° í™•ì¸      |

---

ì´ë ‡ê²Œ í•˜ë©´
ğŸ‘‰ ë¡œì»¬ì—ì„œëŠ” SQLite or Local MySQL,
ğŸ‘‰ Render ë°°í¬ ì‹œì—ëŠ” Neon PostgreSQL
ë¡œ ìë™ ì „í™˜ë˜ë©° ì™„ì „íˆ í´ë¼ìš°ë“œ ìƒì—ì„œ ì‘ë™í•©ë‹ˆë‹¤ âœ…

---

ì›í•˜ì‹ ë‹¤ë©´,
ì´ ì„¤ì • ê¸°ë°˜ìœ¼ë¡œ **Render ë°°í¬ ì§ì „ í…ŒìŠ¤íŠ¸ìš© `deploy_check.py`** (DB ì—°ê²° / OpenAI Key / íŒŒì¼ ê²½ë¡œ ì ê²€ ìŠ¤í¬ë¦½íŠ¸)ë„ ë§Œë“¤ì–´ë“œë¦´ê¹Œìš”?
â†’ â€œë°°í¬ ì „ì— í•œ ë²ˆ ì‹¤í–‰í•´ì„œ ëª¨ë“  ì—°ê²°ì´ ì •ìƒì¸ì§€ ìë™ ì ê²€â€í•˜ëŠ” ìš©ë„ì…ë‹ˆë‹¤.
